# Vulnerability Database

Common vulnerabilities with examples, CWE mappings, and platform-specific guidance.

## Memory Safety Vulnerabilities

### CWE-119: Buffer Overflow

**Description**: Writing data beyond allocated buffer boundaries.

**Example**:
```cpp
char buffer[256];
strcpy(buffer, user_input);  // No bounds checking
```

**Impact**: Code execution, denial of service, data corruption

**Common in**: C/C++, manual memory management

**Mitigation**: Use strncpy, std::string, bounds checking

---

### CWE-190: Integer Overflow

**Description**: Arithmetic operation exceeds maximum value for type.

**Example**:
```cpp
uint32_t size = width * height;  // Overflows if width=0xFFFF, height=0xFFFF
void* buffer = malloc(size);      // Allocates small buffer
```

**Impact**: Buffer overflows, logic errors, incorrect calculations

**Mitigation**: Check before arithmetic, use larger types, SafeInt library

---

### CWE-416: Use-After-Free

**Description**: Accessing memory after it's been freed.

**Example**:
```cpp
delete ptr;
// ... later ...
ptr->method();  // Use after free
```

**Impact**: Code execution, data corruption, crashes

**Mitigation**: Set pointers to nullptr after delete, use smart pointers

---

## Injection Vulnerabilities

### CWE-89: SQL Injection

**Description**: Untrusted data inserted into SQL query.

**Example**:
```cpp
string query = "SELECT * FROM users WHERE name='" + username + "'";
// username = "' OR '1'='1" → returns all users
```

**Impact**: Data breach, authentication bypass, data modification

**Mitigation**: Prepared statements, parameterized queries, ORM

---

### CWE-78: OS Command Injection

**Description**: Untrusted data inserted into system command.

**Example**:
```cpp
system("convert " + user_file + " output.png");
// user_file = "input.jpg; rm -rf /" → executes deletion
```

**Impact**: Arbitrary command execution, system compromise

**Mitigation**: Avoid system(), use exec-style APIs, whitelist inputs

---

### CWE-22: Path Traversal

**Description**: Accessing files outside intended directory.

**Example**:
```cpp
string path = "/data/" + user_filename;
// user_filename = "../../../etc/passwd" → reads system files
```

**Impact**: Unauthorized file access, information disclosure

**Mitigation**: Canonicalize paths, validate no ".." sequences, chroot

---

## Race Conditions

### CWE-367: TOCTOU (Time-of-Check Time-of-Use)

**Description**: State changes between check and use.

**Example**:
```cpp
if (access(filename, R_OK) == 0) {  // Check
    sleep(1);  // Attacker changes file here
    FILE* f = fopen(filename, "r");  // Use - now different file
}
```

**Impact**: Privilege escalation, unauthorized access

**Mitigation**: Use atomic operations, file locks, avoid TOCTOU pattern

---

### CWE-362: Race Condition

**Description**: Multiple threads access shared data without synchronization.

**Example**:
```cpp
// Thread A:                 // Thread B:
if (count < MAX) {           if (count < MAX) {
    count++;                     count++;
    allocate();                  allocate();
}                            }
// Both threads may pass the check, exceeding MAX
```

**Impact**: Data corruption, crashes, security bypass

**Mitigation**: Mutexes, atomic operations, thread-safe data structures

---

## Cryptographic Vulnerabilities

### CWE-327: Use of Broken Cryptography

**Description**: Using weak or deprecated cryptographic algorithms.

**Example**:
```cpp
hash = MD5(password);  // MD5 is broken
hash = SHA1(data);     // SHA1 is deprecated
```

**Impact**: Data exposure, authentication bypass

**Mitigation**: Use SHA-256/SHA-3, bcrypt/scrypt for passwords, Argon2

---

### CWE-330: Insufficient Randomness

**Description**: Predictable random numbers in security contexts.

**Example**:
```cpp
srand(time(NULL));
int token = rand();  // Predictable
```

**Impact**: Session hijacking, CSRF token guessing, weak keys

**Mitigation**: Use /dev/urandom, CSPRNG, crypto libraries

---

### CWE-321: Hard-Coded Cryptographic Key

**Description**: Cryptographic keys embedded in code.

**Example**:
```cpp
const char* AES_KEY = "1234567890abcdef";  // Hardcoded
```

**Impact**: All encrypted data compromised if code leaked

**Mitigation**: Key management system, environment variables, HSM

---

## Platform-Specific Vulnerabilities

### CUDA/GPU (CWE-20: Improper Input Validation)

**Description**: Kernel parameters not validated.

**Example**:
```cpp
__global__ void kernel(float* data, int size) {
    int idx = blockIdx.x * blockDim.x + threadIdx.x;
    data[idx] = ...;  // No check if idx < size
}
```

**Impact**: Out-of-bounds memory access, GPU crash

**Mitigation**: Validate all kernel parameters, bounds checks in kernels

---

### wxWidgets/GUI (CWE-79: Cross-Site Scripting)

**Description**: Untrusted data displayed without encoding.

**Example**:
```cpp
wxTextCtrl* text = new wxTextCtrl(...);
text->SetValue(user_input);  // If user_input contains HTML/scripts
```

**Impact**: UI injection, phishing, data theft

**Mitigation**: HTML entity encoding, sanitize display data

---

### Networking (CWE-20: Improper Input Validation)

**Description**: Network data not validated.

**Example**:
```cpp
int length;
recv(socket, &length, sizeof(length), 0);
char* buffer = new char[length];  // No validation - could be huge
recv(socket, buffer, length, 0);
```

**Impact**: Buffer overflows, DoS, resource exhaustion

**Mitigation**: Validate lengths, enforce maximums, rate limiting

---

## Business Logic Vulnerabilities

### CWE-840: Business Logic Errors

**Description**: Flaws in application logic.

**Example**:
```cpp
// E-commerce: apply discount, then calculate shipping
price = item_price * (1 - discount);
shipping = calculate_shipping(price);  // Shipping should use original price
```

**Impact**: Financial loss, unauthorized access, data manipulation

**Mitigation**: Careful logic review, comprehensive testing, state machines

---

## CVE Examples

### CVE-2014-0160 (Heartbleed)

**Type**: Buffer over-read (CWE-125)

**Description**: TLS heartbeat response could leak memory.

**Lesson**: Always validate length fields from untrusted sources.

---

### CVE-2017-5638 (Apache Struts)

**Type**: Remote code execution via Content-Type header

**Description**: OGNL injection in Content-Type parsing.

**Lesson**: Validate all HTTP headers, not just body.

---

### CVE-2021-44228 (Log4Shell)

**Type**: Remote code execution via JNDI lookup

**Description**: Logging untrusted data triggered JNDI LDAP lookup.

**Lesson**: Sanitize data before logging, disable dangerous features.

---

## OWASP Top 10 (2021)

1. **A01: Broken Access Control** - Authorization failures
2. **A02: Cryptographic Failures** - Weak crypto, exposed sensitive data
3. **A03: Injection** - SQL, command, LDAP injection
4. **A04: Insecure Design** - Missing security controls
5. **A05: Security Misconfiguration** - Default configs, unnecessary features
6. **A06: Vulnerable Components** - Outdated libraries
7. **A07: Authentication Failures** - Weak authentication
8. **A08: Software and Data Integrity** - Unsigned updates, deserialization
9. **A09: Security Logging Failures** - Insufficient logging
10. **A10: Server-Side Request Forgery (SSRF)** - Fetching attacker-controlled URLs

---

## CWE Top 25 (Highlights)

- **CWE-787**: Out-of-bounds Write
- **CWE-79**: Cross-site Scripting
- **CWE-89**: SQL Injection
- **CWE-20**: Improper Input Validation
- **CWE-125**: Out-of-bounds Read
- **CWE-78**: OS Command Injection
- **CWE-416**: Use After Free
- **CWE-22**: Path Traversal
- **CWE-352**: Cross-Site Request Forgery (CSRF)
- **CWE-434**: Unrestricted File Upload

---

## Quick Reference

### Severity Scoring (CVSS v3.1)

- **Critical**: 9.0-10.0 (Immediate action required)
- **High**: 7.0-8.9 (Schedule urgent fix)
- **Medium**: 4.0-6.9 (Plan remediation)
- **Low**: 0.1-3.9 (Monitor, fix when convenient)

### Exploitability Factors

- **Attack Vector**: Network > Adjacent > Local > Physical
- **Attack Complexity**: Low > High
- **Privileges Required**: None > Low > High
- **User Interaction**: None > Required

### Impact Factors

- **Confidentiality**: High > Low > None
- **Integrity**: High > Low > None
- **Availability**: High > Low > None

---

This database is maintained as a quick reference. For detailed CVE information, consult:
- **NIST NVD**: https://nvd.nist.gov/
- **MITRE CWE**: https://cwe.mitre.org/
- **OWASP**: https://owasp.org/
